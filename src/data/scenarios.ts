export interface ScenarioChoice {
  id: string;
  text: string;
  points: number;
  confidenceDelta: number;
  riskLevel: 'low' | 'medium' | 'high';
  feedback: string;
  nextNodeId?: string;
}

export interface ScenarioNode {
  id: string;
  narrative: string;
  situation: string;
  riskIndicator: number; // 0-100
  timeLimit?: number; // seconds
  choices: ScenarioChoice[];
  isEnding?: boolean;
  endingType?: 'safe' | 'risky' | 'empowered';
  reflection?: string;
  lawReference?: string;
}

export interface Scenario {
  id: string;
  title: string;
  description: string;
  category: string;
  icon: string;
  difficulty: 'beginner' | 'intermediate' | 'advanced';
  nodes: Record<string, ScenarioNode>;
  startNodeId: string;
  maxScore: number;
}

export const scenarios: Scenario[] = [
  {
    id: 'late-night-auto',
    title: 'Late Night Auto Ride',
    description: 'You need to get home after working late. Navigate decisions about safe transportation in the city.',
    category: 'Transport Safety',
    icon: 'üõ∫',
    difficulty: 'beginner',
    maxScore: 100,
    startNodeId: 'start',
    nodes: {
      start: {
        id: 'start',
        narrative: 'It\'s 10:30 PM. You just finished overtime at work in Bangalore. Your regular bus has stopped running. You need to get to your PG accommodation 8 km away.',
        situation: 'Outside your office building. The street is moderately lit. A few colleagues are also leaving.',
        riskIndicator: 30,
        choices: [
          {
            id: 'share-location',
            text: 'Share your live location with a trusted contact before booking a ride',
            points: 25,
            confidenceDelta: 5,
            riskLevel: 'low',
            feedback: 'Excellent! Sharing your live location is one of the most important safety steps. Your trusted contact can monitor your journey.',
            nextNodeId: 'booked-ride',
          },
          {
            id: 'random-auto',
            text: 'Quickly hail a passing auto-rickshaw from the street',
            points: 5,
            confidenceDelta: -5,
            riskLevel: 'high',
            feedback: 'Taking an untracked auto late at night can be risky. Consider using app-based rides where the driver\'s identity and route are recorded.',
            nextNodeId: 'street-auto',
          },
          {
            id: 'colleague-ride',
            text: 'Ask a colleague heading in the same direction to share a cab',
            points: 20,
            confidenceDelta: 3,
            riskLevel: 'low',
            feedback: 'Good thinking! Travelling with someone you know is safer, especially late at night.',
            nextNodeId: 'shared-ride',
          },
        ],
      },
      'booked-ride': {
        id: 'booked-ride',
        narrative: 'You\'ve shared your location with your sister and booked an app-based auto. The app shows the driver\'s photo, name, and vehicle number. The auto arrives, but the vehicle number doesn\'t match the app.',
        situation: 'Standing outside office. An auto with a different number plate has arrived, driver says "your auto is here."',
        riskIndicator: 65,
        choices: [
          {
            id: 'refuse-wrong',
            text: 'Refuse to get in and report the mismatch on the app',
            points: 30,
            confidenceDelta: 10,
            riskLevel: 'low',
            feedback: 'Perfect decision! Never get into a vehicle that doesn\'t match the details shown on the app. This is a critical safety check. Report it immediately.',
            nextNodeId: 'safe-wait',
          },
          {
            id: 'ask-name',
            text: 'Ask the driver to confirm YOUR name (not the other way around)',
            points: 20,
            confidenceDelta: 5,
            riskLevel: 'medium',
            feedback: 'Smart approach! Always ask the driver to tell you the passenger name ‚Äî never say yours first. But the vehicle mismatch is still a red flag.',
            nextNodeId: 'verify-driver',
          },
          {
            id: 'get-in',
            text: 'Get in anyway since it\'s getting late',
            points: 0,
            confidenceDelta: -10,
            riskLevel: 'high',
            feedback: 'This is dangerous. A mismatched vehicle number is a major red flag. No matter how late it is, never compromise on verifying ride details.',
            nextNodeId: 'risky-ride',
          },
        ],
      },
      'street-auto': {
        id: 'street-auto',
        narrative: 'You\'ve hailed a street auto. The driver agrees to the fare. As you get in, you notice there\'s no fare meter and the registration plate is partially covered.',
        situation: 'Inside an untracked auto. The driver takes an unfamiliar route.',
        riskIndicator: 75,
        choices: [
          {
            id: 'exit-safely',
            text: 'Ask the driver to stop at the next well-lit, populated area and exit',
            points: 25,
            confidenceDelta: 8,
            riskLevel: 'medium',
            feedback: 'Good instinct. When something feels wrong, trust your gut. Exit at a safe, populated spot. Remember: you can always call 112 for emergency help.',
            nextNodeId: 'safe-exit',
            
          },
          {
            id: 'call-someone',
            text: 'Call a friend or family member and loudly describe the auto and route',
            points: 20,
            confidenceDelta: 5,
            riskLevel: 'medium',
            feedback: 'Making a call and describing details of the vehicle loudly serves as a deterrent. The driver knows someone is aware of your situation.',
            nextNodeId: 'aware-ride',
          },
          {
            id: 'stay-quiet',
            text: 'Stay quiet and hope for the best',
            points: 0,
            confidenceDelta: -8,
            riskLevel: 'high',
            feedback: 'Staying passive in a concerning situation can be dangerous. Always take proactive steps to ensure your safety.',
            nextNodeId: 'risky-ride',
          },
        ],
      },
      'shared-ride': {
        id: 'shared-ride',
        narrative: 'You and your colleague Priya share a cab home. She gets dropped first. The driver now suggests a "shortcut" through a less-traveled road.',
        situation: 'In a cab alone after your colleague was dropped. Driver suggests an unfamiliar route.',
        riskIndicator: 55,
        choices: [
          {
            id: 'insist-main-road',
            text: 'Firmly tell the driver to stick to the main road shown on GPS',
            points: 25,
            confidenceDelta: 8,
            riskLevel: 'low',
            feedback: 'Asserting yourself firmly is the right choice. You have every right to decide the route. Legitimate drivers will not insist on deviations.',
            nextNodeId: 'safe-ending',
          },
          {
            id: 'note-details',
            text: 'Note the driver\'s details, share them on a call, and keep navigation on',
            points: 20,
            confidenceDelta: 5,
            riskLevel: 'medium',
            feedback: 'Good awareness! Keeping a live call and monitoring the route is a strong safety practice.',
            nextNodeId: 'safe-ending',
          },
          {
            id: 'agree-shortcut',
            text: 'Agree to the shortcut since the driver probably knows the area better',
            points: 0,
            confidenceDelta: -5,
            riskLevel: 'high',
            feedback: 'Trust your instincts over convenience. "Shortcuts" through isolated roads late at night are red flags. Always stick to well-lit, main routes.',
            nextNodeId: 'risky-ride',
          },
        ],
      },
      'safe-wait': {
        id: 'safe-wait',
        narrative: 'You reported the mismatched vehicle and booked a new ride. This time, everything matches ‚Äî driver name, photo, and vehicle number. You verify before getting in and share the ride details with your sister.',
        situation: 'In a verified, tracked ride heading home safely.',
        riskIndicator: 10,
        isEnding: true,
        endingType: 'empowered',
        reflection: 'You made every right decision tonight. You shared your location, verified ride details, refused a mismatched vehicle, and stayed in a safe zone while waiting. These habits save lives.',
        lawReference: 'Remember: Under Section 354D IPC, stalking is a criminal offense. Under the Motor Vehicles Act, all commercial vehicles must display proper registration. You can file a complaint at cybercrime.gov.in for suspicious ride-share incidents.',
        choices: [],
      },
      'verify-driver': {
        id: 'verify-driver',
        narrative: 'The driver couldn\'t confirm your name correctly. You decide not to take the ride and move back to your office security guard\'s area while booking another ride.',
        situation: 'Safely back near your office building with security personnel.',
        riskIndicator: 15,
        isEnding: true,
        endingType: 'safe',
        reflection: 'You used the name verification technique well. When combined with vehicle checks, this creates a strong safety net. Always wait in secure areas when rebooking.',
        choices: [],
      },
      'safe-exit': {
        id: 'safe-exit',
        narrative: 'You exit at a busy junction near a 24-hour medical store. You book a tracked ride from there and reach home safely. Before leaving, you note the auto\'s partial number plate to report later.',
        situation: 'At a busy junction, safe and alert.',
        riskIndicator: 15,
        isEnding: true,
        endingType: 'safe',
        reflection: 'Trusting your instincts and exiting a suspicious vehicle is always the right call. Remember the helpline numbers: 112 (Emergency), 181 (Women Helpline), 1091 (Women in Distress).',
        lawReference: 'You can report suspicious drivers and vehicles to the police. Under IPC Section 354, assault or criminal force used against a woman is punishable with up to 2 years imprisonment.',
        choices: [],
      },
      'aware-ride': {
        id: 'aware-ride',
        narrative: 'The driver notices you on the phone describing his vehicle. He gets back to the regular route. You reach home safely and report the incident on the auto-stand complaint board the next day.',
        situation: 'Reached home safely through awareness.',
        riskIndicator: 20,
        isEnding: true,
        endingType: 'safe',
        reflection: 'Making a phone call and loudly sharing details acts as a strong deterrent. You turned a risky situation into a managed one through awareness and action.',
        choices: [],
      },
      'risky-ride': {
        id: 'risky-ride',
        narrative: 'The situation becomes uncomfortable. You realize you should have been more cautious. You immediately call 112 and the dispatcher stays on the line, guiding you until you reach a safe area. You\'re physically safe, but shaken.',
        situation: 'You are now safe but the experience was frightening.',
        riskIndicator: 80,
        isEnding: true,
        endingType: 'risky',
        reflection: 'This experience highlights why proactive safety steps matter. It\'s never your fault when someone makes you feel unsafe ‚Äî but having safety habits can help prevent such situations. Remember: 112 is available 24/7 across India.',
        lawReference: 'Important: Under IPC 354, criminal force against a woman is punishable. Under 354D, stalking is criminal. You can file an FIR at any police station ‚Äî they cannot refuse (Section 154 CrPC). You can also file complaints at sheboxonline.wcd.nic.in.',
        choices: [],
      },
      'safe-ending': {
        id: 'safe-ending',
        narrative: 'The driver stays on the main road. You reach your PG accommodation safely. You made the right choices and showed strong situational awareness throughout the journey.',
        situation: 'Home safe.',
        riskIndicator: 5,
        isEnding: true,
        endingType: 'empowered',
        reflection: 'Asserting your preferences, staying aware, and keeping trusted contacts informed ‚Äî these are powerful safety habits. You navigated this situation with confidence and awareness.',
        choices: [],
      },
    },
  },
  {
    id: 'workplace-harassment',
    title: 'Workplace Boundaries',
    description: 'Navigate a workplace situation involving inappropriate behavior from a senior colleague. Learn about the POSH Act and your rights.',
    category: 'Workplace Safety',
    icon: 'üè¢',
    difficulty: 'intermediate',
    maxScore: 100,
    startNodeId: 'start',
    nodes: {
      start: {
        id: 'start',
        narrative: 'You\'re a new employee at a tech company in Hyderabad. Your team lead, Mr. Sharma, has been sending you personal messages after work hours and making comments about your appearance during meetings.',
        situation: 'At your desk. Mr. Sharma just sent another personal message asking you to meet for coffee "to discuss your performance" ‚Äî outside office.',
        riskIndicator: 45,
        choices: [
          {
            id: 'document',
            text: 'Screenshot the messages and start documenting every incident with dates and details',
            points: 30,
            confidenceDelta: 8,
            riskLevel: 'low',
            feedback: 'Excellent first step! Documentation is crucial. Save screenshots, note dates, times, witnesses, and exact words used. This evidence is vital if you decide to file a complaint.',
            nextNodeId: 'documented',
          },
          {
            id: 'confront-politely',
            text: 'Reply professionally: "I prefer to keep communications work-related and during office hours"',
            points: 20,
            confidenceDelta: 5,
            riskLevel: 'medium',
            feedback: 'Setting boundaries clearly is important. However, also document this exchange. A written record of you setting boundaries strengthens any future complaint.',
            nextNodeId: 'boundary-set',
          },
          {
            id: 'ignore',
            text: 'Ignore the message and hope he stops on his own',
            points: 5,
            confidenceDelta: -3,
            riskLevel: 'medium',
            feedback: 'While it\'s understandable to want to avoid confrontation, ignoring the behavior often allows it to escalate. You deserve a safe workplace.',
            nextNodeId: 'escalation',
          },
        ],
      },
      documented: {
        id: 'documented',
        narrative: 'You\'ve documented 5 incidents over 2 weeks. Today in a meeting, Mr. Sharma puts his hand on your shoulder while leaning over your laptop, making you uncomfortable. Two colleagues notice.',
        situation: 'In a meeting room. Colleagues Anita and Rahul witnessed the incident.',
        riskIndicator: 60,
        choices: [
          {
            id: 'icc-complaint',
            text: 'File a formal complaint with the Internal Complaints Committee (ICC)',
            points: 30,
            confidenceDelta: 12,
            riskLevel: 'low',
            feedback: 'Under the POSH Act 2013, every organization with 10+ employees MUST have an ICC. Filing a complaint is your legal right. The ICC must resolve it within 90 days. Your identity will be kept confidential.',
            nextNodeId: 'icc-filed',
          },
          {
            id: 'talk-hr',
            text: 'Approach HR informally first to understand your options',
            points: 20,
            confidenceDelta: 5,
            riskLevel: 'low',
            feedback: 'HR can guide you through the process. Make sure to still keep your documentation. Under POSH Act, HR is obligated to inform you about the ICC and complaint process.',
            nextNodeId: 'hr-meeting',
          },
          {
            id: 'ask-witnesses',
            text: 'Ask Anita and Rahul if they\'d be willing to support your account',
            points: 25,
            confidenceDelta: 8,
            riskLevel: 'low',
            feedback: 'Witness testimony strengthens your case. It\'s perfectly appropriate to ask colleagues who witnessed the behavior if they\'d corroborate your account.',
            nextNodeId: 'icc-filed',
          },
        ],
      },
      'boundary-set': {
        id: 'boundary-set',
        narrative: 'Mr. Sharma replies dismissively: "Don\'t be so uptight, I\'m just being friendly." The next day, he assigns you a heavy workload while reducing tasks for others, possibly in retaliation.',
        situation: 'At work. Experiencing possible retaliation after setting boundaries.',
        riskIndicator: 55,
        choices: [
          {
            id: 'document-retaliation',
            text: 'Document the retaliation and approach the ICC with both harassment and retaliation evidence',
            points: 30,
            confidenceDelta: 10,
            riskLevel: 'low',
            feedback: 'Retaliation after setting boundaries is itself a violation under POSH Act. Document the change in workload with before-and-after evidence. This strengthens your complaint significantly.',
            nextNodeId: 'icc-filed',
          },
          {
            id: 'external-help',
            text: 'Contact the Local Complaints Committee (LCC) or a women\'s rights helpline',
            points: 25,
            confidenceDelta: 8,
            riskLevel: 'low',
            feedback: 'If you feel the internal process might be biased, the LCC (set up by the District Officer) can handle your complaint. You can also call 181 (Women Helpline) for guidance.',
            nextNodeId: 'icc-filed',
          },
          {
            id: 'quit',
            text: 'Consider leaving the job to avoid the situation',
            points: 5,
            confidenceDelta: -10,
            riskLevel: 'high',
            feedback: 'You should not have to leave your job due to someone else\'s inappropriate behavior. The law protects you. Under POSH Act, you can also request transfer of the respondent, not yourself.',
            nextNodeId: 'icc-filed',
          },
        ],
      },
      escalation: {
        id: 'escalation',
        narrative: 'Without intervention, the behavior has escalated. Mr. Sharma now makes comments in front of others and has started texting you late at night. A colleague, Anita, privately tells you she\'s noticed and is concerned.',
        situation: 'Behavior has escalated. A supportive colleague reaches out.',
        riskIndicator: 70,
        choices: [
          {
            id: 'accept-help',
            text: 'Thank Anita and ask her to help you document and navigate the complaint process',
            points: 25,
            confidenceDelta: 10,
            riskLevel: 'low',
            feedback: 'Having an ally is incredibly valuable. Anita can serve as a witness and emotional support. Start documenting now ‚Äî it\'s never too late to take action.',
            nextNodeId: 'icc-filed',
          },
          {
            id: 'start-documenting-now',
            text: 'Begin documenting everything from this point and file a complaint with ICC',
            points: 25,
            confidenceDelta: 8,
            riskLevel: 'low',
            feedback: 'It\'s never too late to start documenting and filing a complaint. Under POSH Act, you can file within 3 months of the last incident (extendable to 6 months).',
            nextNodeId: 'icc-filed',
          },
          {
            id: 'continue-ignoring',
            text: 'Tell Anita it\'s fine and continue ignoring',
            points: 0,
            confidenceDelta: -8,
            riskLevel: 'high',
            feedback: 'Your wellbeing matters. Persistent unwanted behavior that creates a hostile work environment is workplace sexual harassment under law. You deserve better.',
            nextNodeId: 'icc-filed',
          },
        ],
      },
      'hr-meeting': {
        id: 'hr-meeting',
        narrative: 'HR informs you about the ICC process and your rights under the POSH Act. They assure confidentiality. You feel ready to take the next step.',
        situation: 'After HR consultation. Ready to file formal complaint.',
        riskIndicator: 30,
        isEnding: true,
        endingType: 'empowered',
        reflection: 'Seeking information before acting is wise. You now know your rights: the POSH Act protects you, the ICC must act within 90 days, your identity is confidential, and retaliation is illegal. Knowledge is power.',
        lawReference: 'POSH Act 2013: Every employer must constitute an ICC. Complaints must be resolved in 90 days. Complainant identity is protected. Section 354A IPC covers sexual harassment with up to 3 years imprisonment.',
        choices: [],
      },
      'icc-filed': {
        id: 'icc-filed',
        narrative: 'You file a formal complaint with the ICC, supported by your documentation. The ICC acknowledges your complaint and begins the inquiry process. You\'re informed of your right to request interim measures like transfer of the respondent.',
        situation: 'Formal complaint filed. ICC process initiated.',
        riskIndicator: 15,
        isEnding: true,
        endingType: 'empowered',
        reflection: 'Filing a complaint is an act of courage. The law is on your side. The POSH Act ensures a fair process with confidentiality protections. You\'ve not only protected yourself but potentially helped other colleagues who may face similar situations.',
        lawReference: 'Key POSH Act provisions: Internal Complaints Committee is mandatory (10+ employees). 90-day resolution timeline. Confidentiality guaranteed. Interim relief available. Retaliation is punishable. You can also approach the Local Complaints Committee (LCC) if ICC is absent or biased.',
        choices: [],
      },
    },
  },
  {
    id: 'online-safety',
    title: 'Digital Safety Shield',
    description: 'Handle a cyberstalking situation ‚Äî learn about online safety, privacy settings, and cyber laws in India.',
    category: 'Online Safety',
    icon: 'üîí',
    difficulty: 'intermediate',
    maxScore: 100,
    startNodeId: 'start',
    nodes: {
      start: {
        id: 'start',
        narrative: 'You receive a friend request on Instagram from someone you don\'t recognize. They claim to be a college senior. You notice they\'ve already liked several of your old photos and have been commenting with personal compliments.',
        situation: 'On your phone. Unknown person showing intense interest in your social media.',
        riskIndicator: 35,
        choices: [
          {
            id: 'check-privacy',
            text: 'Review and tighten your privacy settings immediately before responding',
            points: 25,
            confidenceDelta: 8,
            riskLevel: 'low',
            feedback: 'Smart first move! Making your profile private and reviewing who can see your posts/stories/location is essential digital safety.',
            nextNodeId: 'privacy-tightened',
          },
          {
            id: 'accept-request',
            text: 'Accept the request ‚Äî they might genuinely be from college',
            points: 5,
            confidenceDelta: -3,
            riskLevel: 'high',
            feedback: 'Accepting requests from unverified strangers gives them access to your personal information, photos, and potentially your location. Always verify identity through mutual contacts first.',
            nextNodeId: 'accepted-stranger',
          },
          {
            id: 'verify-first',
            text: 'Ask mutual friends if they know this person before responding',
            points: 20,
            confidenceDelta: 5,
            riskLevel: 'low',
            feedback: 'Good approach! Verifying through mutual connections is a smart way to check if someone is genuine before giving them access to your profile.',
            nextNodeId: 'privacy-tightened',
          },
        ],
      },
      'privacy-tightened': {
        id: 'privacy-tightened',
        narrative: 'After tightening your settings, the person creates a second account and sends you a DM on that account. The message references details about your daily routine ‚Äî your college timing and the caf√© you visit.',
        situation: 'Someone is showing stalking behavior ‚Äî monitoring your movements and creating multiple accounts.',
        riskIndicator: 70,
        choices: [
          {
            id: 'screenshot-report',
            text: 'Screenshot everything and file a report on cybercrime.gov.in',
            points: 30,
            confidenceDelta: 10,
            riskLevel: 'low',
            feedback: 'This is cyberstalking. Under IT Act Section 67 and IPC 354D, this is criminal. File at cybercrime.gov.in or call 1930 (Cyber Crime Helpline). Screenshots are crucial evidence.',
            nextNodeId: 'reported',
          },
          {
            id: 'block-both',
            text: 'Block both accounts and restrict who can message you',
            points: 15,
            confidenceDelta: 3,
            riskLevel: 'medium',
            feedback: 'Blocking is necessary but may not be sufficient. Stalkers often create new accounts. Consider filing a formal report to create a legal record.',
            nextNodeId: 'reported',
          },
          {
            id: 'confront-dm',
            text: 'Confront the person over DM and tell them to stop',
            points: 10,
            confidenceDelta: 0,
            riskLevel: 'medium',
            feedback: 'Direct confrontation with stalkers can sometimes escalate the situation. It\'s better to report through official channels where trained professionals handle it.',
            nextNodeId: 'reported',
          },
        ],
      },
      'accepted-stranger': {
        id: 'accepted-stranger',
        narrative: 'After accepting, the person begins messaging frequently, asking personal questions about where you live, your family, and whether you live alone. They share a photo claiming it\'s them near your college.',
        situation: 'A stranger now has access to your profile and is showing stalking behavior.',
        riskIndicator: 80,
        choices: [
          {
            id: 'immediate-action',
            text: 'Block, report the profile, screenshot everything, and change your privacy settings',
            points: 25,
            confidenceDelta: 8,
            riskLevel: 'low',
            feedback: 'Good recovery! When you realize a situation is dangerous, taking immediate action is always right. Save all evidence and consider filing a cybercrime report.',
            nextNodeId: 'reported',
          },
          {
            id: 'tell-someone',
            text: 'Tell a trusted friend or family member about the situation immediately',
            points: 20,
            confidenceDelta: 5,
            riskLevel: 'low',
            feedback: 'Telling someone you trust is important ‚Äî both for emotional support and safety. They can help you take next steps like reporting to cyber cell.',
            nextNodeId: 'reported',
          },
          {
            id: 'keep-engaging',
            text: 'Try to find out who they really are by asking questions',
            points: 0,
            confidenceDelta: -8,
            riskLevel: 'high',
            feedback: 'Engaging further with a potential stalker can be dangerous. It provides them with more information and encourages continued contact. Disengage and report.',
            nextNodeId: 'reported',
          },
        ],
      },
      reported: {
        id: 'reported',
        narrative: 'You take action and report the incident. The cyber cell acknowledges your complaint and advises you on additional steps: enable two-factor authentication, review all your digital footprint, and be cautious about location sharing.',
        situation: 'Report filed. Taking steps to strengthen your digital safety.',
        riskIndicator: 15,
        isEnding: true,
        endingType: 'empowered',
        reflection: 'Cyberstalking is a crime in India. You have the right to a safe digital space. Regular privacy audits, two-factor authentication, and being mindful of what you share online are ongoing safety habits.',
        lawReference: 'IT Act Section 67: Publishing obscene material. IPC 354D: Stalking (up to 3 years imprisonment for repeat offense). IPC 509: Word, gesture or act intended to insult modesty. File complaints at cybercrime.gov.in or call 1930. Under Section 354C, voyeurism is punishable with up to 7 years.',
        choices: [],
      },
    },
  },
];
